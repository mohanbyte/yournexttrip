<!-- Package Header -->
<div
  class="container-fluid package-header d-flex align-items-center justify-content-center text-center text-white py-5"
  style="background-size: cover; background-position: center"
  [style.background]="
    'linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url(' +
    getImageUrl(city) +
    ')'
  "
>
  <div class="container py-5">
    <div class="row justify-content-center">
      <div class="col-lg-8">
        <h1 class="display-4 fw-bold mb-4" style="color: #fe512e">
          {{
            tourDetails.title ||
              "Explore the Spiritual Heart of India – Varanasi"
          }}
        </h1>
        <p class="fs-5 mb-4 text-white">
          {{
            tourDetails.description ||
              "Discover the ancient city where spirituality, history, and culture come alive along the sacred Ganges River."
          }}
        </p>
        <div class="d-flex justify-content-center gap-3">
          @for(tag of tourDetails.tags; track $index; let index = $index){ @if
          (index<3) {
          <div class="bg-primary px-3 py-1 rounded-pill text-white">
            <i class="fas fa-map-marker-alt me-2"></i>{{ tag | titlecase }}
          </div>
          } }
        </div>
        <div class="mt-4">
          <span class="price-highlight"
            >Starting from ₹{{ tourDetails.price | number : "1.0-0" }}*</span
          >
          <p class="small text-white mt-1">
            *Price per person for group of {{ selectedTravelers }} | T&C apply
          </p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Main Content -->
<div class="container-fluid py-5">
  <div class="container py-5">
    <div class="row g-5">
      <div class="col-lg-8">
        <!-- Package Highlights -->
        <div class="mb-5">
          <div class="card shadow-sm border-0">
            <div class="card-header bg-primary text-white">
              <h2 class="mb-0 h4">Tour Highlights</h2>
            </div>
            <div class="card-body">
              <div class="row g-4">
                <div
                  class="col-md-6"
                  *ngFor="let highlight of tourDetails.highlights"
                >
                  <div class="highlight-item p-3 rounded">
                    <h5 class="mb-2">
                      <i class="fas fa-check-circle text-success me-2"></i
                      >{{ highlight }}
                    </h5>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Package Description -->
        <div class="mb-5">
          <div class="card shadow-sm border-0">
            <div class="card-header bg-primary text-white">
              <h2 class="mb-0 h4">Package Overview</h2>
            </div>
            <div class="card-body">
              <p>
                {{
                  tourDetails.overview ||
                    "Explore the spiritual heart of India – Varanasi. Discover the ancient city where spirituality, history, and culture come alive along the sacred Ganges River."
                }}
              </p>
              <p>
                {{
                  tourDetails.detailedDesc ||
                    "Immerse yourself in the spiritual essence of Varanasi with our expertly curated tour package. Experience the divine Ganga Aarti at Dashashwamedh Ghat, enjoy a boat ride on the holy Ganges River at sunrise, and explore the historic Sarnath – the land of Buddha's first sermon."
                }}
              </p>
            </div>
          </div>
        </div>

        <!-- Pricing Table -->
        <div class="mb-5">
          <div class="card shadow-sm border-0">
            <div class="card-header bg-primary text-white">
              <h2 class="mb-0 h4">Pricing Details</h2>
            </div>
            <div class="card-body p-0">
              <div class="table-responsive">
                <table class="table table-striped table-bordered">
                  <thead class="table-dark">
                    <tr>
                      <th>Group Size</th>
                      <th>Total Price (₹)</th>
                      <th>Price per Person (₹)</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr
                      *ngFor="let pricing of tourDetails.pricingDetails"
                      [class.highlight-row]="pricing.groupSize === 5"
                    >
                      <td>{{ pricing.groupSize }}</td>
                      <td>{{ pricing.basePackageTotal | number : "1.0-0" }}</td>
                      <td>{{ pricing.pricePerPerson | number : "1.0-0" }}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- Package Gallery -->
        <div class="mb-5">
          <div class="card shadow-sm border-0">
            <div class="card-header bg-primary text-white">
              <h2 class="mb-0 h4">Photo Gallery</h2>
            </div>
            <div class="card-body p-0">
              <div class="row p-2 g-3">
                @for(imageIndex of [1, 2, 3, 4, 5, 6]; track $index; let index =
                $index) {
                <div class="col-md-4">
                  <img
                    [src]="getTourImageUrl(index)"
                    class="img-fluid rounded shadow-sm"
                    alt="Ganga Aarti at Varanasi"
                  />
                </div>
                }
              </div>
            </div>
          </div>
        </div>

        <!-- Itinerary Section -->
        <div class="mb-5">
          <div class="card shadow-sm border-0">
            <div class="card-header bg-primary text-white">
              <h2 class="mb-0 h4">Tour Itinerary</h2>
            </div>
            <div class="card-body">
              <!-- Day 1 -->
              <div class="itinerary-day rounded p-4 mb-4">
                <h4 class="d-flex align-items-center">
                  <span class="badge bg-primary me-3">Day 1</span>
                  <span>Varanasi Spiritual Experience</span>
                </h4>
                <div class="mt-3">
                  <div class="faq-item">
                    <div class="faq-question d-flex align-items-center">
                      <i class="fas fa-sun me-2 text-warning"></i>
                      <span>Morning: Sunrise Boat Ride & Temple Visit</span>
                    </div>
                    <div class="faq-answer mt-2 ps-4">
                      <p>
                        • Pickup from Airport/Railway Station/Hotel at 5:30 AM
                      </p>
                      <p>
                        • Private sunrise boat ride on the holy Ganges River
                      </p>
                      <p>
                        • Visit to the sacred Kashi Vishwanath Temple for
                        darshan
                      </p>
                      <p>• Breakfast at hotel and some time to relax</p>
                    </div>
                  </div>
                  <div class="faq-item">
                    <div class="faq-question d-flex align-items-center">
                      <i class="fas fa-utensils me-2 text-info"></i>
                      <span>Afternoon: Market Exploration</span>
                    </div>
                    <div class="faq-answer mt-2 ps-4">
                      <p>
                        • Walk through Vishwanath Gali and explore the bustling
                        local markets
                      </p>
                      <p>
                        • Free time for lunch (self-arranged) or relax at hotel
                      </p>
                    </div>
                  </div>
                  <div class="faq-item">
                    <div class="faq-question d-flex align-items-center">
                      <i class="fas fa-moon me-2 text-secondary"></i>
                      <span>Evening: Ganga Aarti Experience</span>
                    </div>
                    <div class="faq-answer mt-2 ps-4">
                      <p>
                        • Witness the mesmerizing Ganga Aarti Ceremony at
                        Dashashwamedh Ghat
                      </p>
                      <p>
                        • Leisurely stroll along the ghats to experience the
                        vibrant atmosphere
                      </p>
                      <p>• Return to hotel for overnight stay</p>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Day 2 -->
              <div class="itinerary-day rounded p-4 mb-4">
                <h4 class="d-flex align-items-center">
                  <span class="badge bg-primary me-3">Day 2</span>
                  <span>Sarnath Excursion & Departure</span>
                </h4>
                <div class="mt-3">
                  <div class="faq-item">
                    <div class="faq-question d-flex align-items-center">
                      <i class="fas fa-university me-2 text-success"></i>
                      <span>Morning: Sarnath Exploration</span>
                    </div>
                    <div class="faq-answer mt-2 ps-4">
                      <p>
                        • Visit to Sarnath, the sacred site where Lord Buddha
                        gave his first sermon
                      </p>
                      <p>
                        • Explore Dhamek Stupa, Mulagandha Kuti Vihar, and the
                        Sarnath Museum
                      </p>
                    </div>
                  </div>
                  <div class="faq-item">
                    <div class="faq-question d-flex align-items-center">
                      <i class="fas fa-shopping-bag me-2 text-danger"></i>
                      <span>Afternoon: Shopping & Departure</span>
                    </div>
                    <div class="faq-answer mt-2 ps-4">
                      <p>
                        • Optional visit to local markets for shopping Banarasi
                        silk sarees and handicrafts
                      </p>
                      <p>
                        • Departure transfer to Airport/Railway Station based on
                        your travel schedule
                      </p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="alert alert-info mt-4">
                <i class="fas fa-info-circle me-2"></i>
                <strong>Note:</strong> The schedule is flexible and can be
                adjusted depending on your exact arrival and departure times.
              </div>
            </div>
          </div>
        </div>

        <!-- Inclusions/Exclusions -->
        <div class="row mb-5">
          <div class="col-md-6">
            <div class="card shadow-sm border-0">
              <div class="card-header bg-success text-white">
                <h4 class="mb-0 h5">
                  <i class="fas fa-check-circle me-2"></i> Package Inclusions
                </h4>
              </div>
              <div class="card-body">
                <ul class="inclusion-list">
                  <li *ngFor="let inclusion of tourDetails.package_inclusions">
                    {{ inclusion }}
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card shadow-sm border-0">
              <div class="card-header bg-danger text-white">
                <h4 class="mb-0 h5">
                  <i class="fas fa-times-circle me-2"></i> Package Exclusions
                </h4>
              </div>
              <div class="card-body">
                <ul class="inclusion-list exclusion-list">
                  <li *ngFor="let exclusion of tourDetails.package_exclusions">
                    {{ exclusion }}
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <!-- Important Information -->
        <div class="mb-5">
          <div class="card shadow-sm border-0">
            <div class="card-header bg-info text-white">
              <h2 class="mb-0 h4">Important Information</h2>
            </div>
            <div class="card-body p-0">
              <div class="accordion" id="infoAccordion">
                <div class="accordion-item">
                  <h3 class="accordion-header">
                    <button
                      class="accordion-button"
                      type="button"
                      data-bs-toggle="collapse"
                      data-bs-target="#collapseOne"
                    >
                      <i class="fas fa-suitcase me-2"></i> What to bring
                    </button>
                  </h3>
                  <div
                    id="collapseOne"
                    class="accordion-collapse collapse show"
                    data-bs-parent="#infoAccordion"
                  >
                    <div class="accordion-body">
                      <ul>
                        <li>Passport or ID card</li>
                        <li>Comfortable walking shoes</li>
                        <li>Modest clothing for temple visits</li>
                        <li>Camera for photos</li>
                        <li>Sun protection (hat, sunscreen)</li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="accordion-item">
                  <h3 class="accordion-header">
                    <button
                      class="accordion-button collapsed"
                      type="button"
                      data-bs-toggle="collapse"
                      data-bs-target="#collapseTwo"
                    >
                      <i class="fas fa-ban me-2"></i> Not allowed
                    </button>
                  </h3>
                  <div
                    id="collapseTwo"
                    class="accordion-collapse collapse"
                    data-bs-parent="#infoAccordion"
                  >
                    <div class="accordion-body">
                      <ul>
                        <li>Alcohol and drugs</li>
                        <li>Revealing clothing in temples</li>
                        <li>Leather items in temple premises</li>
                        <li>Plastic bags near ghats</li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="accordion-item">
                  <h3 class="accordion-header">
                    <button
                      class="accordion-button collapsed"
                      type="button"
                      data-bs-toggle="collapse"
                      data-bs-target="#collapseThree"
                    >
                      <i class="fas fa-info-circle me-2"></i> Know before you go
                    </button>
                  </h3>
                  <div
                    id="collapseThree"
                    class="accordion-collapse collapse"
                    data-bs-parent="#infoAccordion"
                  >
                    <div class="accordion-body">
                      <ul>
                        <li *ngFor="let info of tourDetails.information">
                          {{ info }}
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Booking Sidebar -->
      <div class="col-lg-4">
        <div class="card shadow-lg border-0 booking-card">
          <div class="card-header bg-primary text-white">
            <h3 class="mb-0">Book This Tour</h3>
          </div>
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center mb-4">
              <span class="package-price" id="selected-price"
                ><span class="text-primary fw-bold"
                  >₹{{
                    selectedPricing.pricePerPerson | number : "1.0-0"
                  }}*</span
                ></span
              >
              <span class="badge bg-success">Bestseller</span>
            </div>
            <p class="small text-muted mb-4" id="selected-group">
              *Price per person for group of {{ selectedTravelers }} | T&C apply
            </p>
            <form id="bookingForm" action="sendEmailnow.php" method="POST">
              <input type="hidden" name="package" [value]="tourDetails.title" />
              <input
                type="hidden"
                id="package-price"
                name="price_per_person"
                [value]="selectedPricing.pricePerPerson"
              />
              <input
                type="hidden"
                id="total-price"
                name="total_price"
                [value]="selectedPricing.basePackageTotal"
              />
              <input
                type="hidden"
                name="recipient_email"
                value="info@yournexttrip.in"
              />
              <div class="mb-4">
                <label class="form-label">Number of Travelers*</label>
                <select
                  class="form-select"
                  name="travelers"
                  id="travelers-select"
                  required
                  (change)="onTravelersChange($event)"
                  [value]="selectedTravelers"
                >
                  <option
                    *ngFor="let pricing of tourDetails.pricingDetails"
                    [value]="pricing.groupSize"
                  >
                    {{ pricing.groupSize }} People
                  </option>
                </select>
              </div>
              <div class="mb-4">
                <label class="form-label">Select Date*</label>
                <input type="date" class="form-control" name="date" required />
              </div>
              <div class="mb-4">
                <label class="form-label">Your Name*</label>
                <input type="text" class="form-control" name="name" required />
              </div>
              <div class="mb-4">
                <label class="form-label">Email Address*</label>
                <input
                  type="email"
                  class="form-control"
                  name="email"
                  required
                />
              </div>
              <div class="mb-4">
                <label class="form-label">Phone Number*</label>
                <input type="tel" class="form-control" name="phone" required />
              </div>
              <!-- Cost Breakdown Card -->
              <div class="card border-primary mb-4" id="cost-breakdown">
                <div class="card-header bg-primary text-white">
                  <h6 class="mb-0">Cost Breakdown</h6>
                </div>
                <div class="card-body">
                  <div class="row">
                    <div class="col-6">
                      <p class="mb-1 small text-muted">Group Size:</p>
                      <p class="mb-1 small text-muted">Total Package:</p>
                      <p class="mb-1 small text-muted">Per Person:</p>
                    </div>
                    <div class="col-6 text-end">
                      <p class="mb-1">
                        <strong id="current-group-size"
                          >{{ selectedTravelers }} People</strong
                        >
                      </p>
                      <p class="mb-1">
                        <strong id="total-package-cost"
                          >₹{{
                            selectedPricing.basePackageTotal | number : "1.0-0"
                          }}</strong
                        >
                      </p>
                      <p class="mb-1">
                        <strong class="text-primary" id="cost-per-person"
                          >₹{{
                            selectedPricing.pricePerPerson | number : "1.0-0"
                          }}</strong
                        >
                      </p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-check mb-4">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="termsCheck"
                  required
                />
                <label class="form-check-label small" for="termsCheck">
                  I agree to the
                  <a
                    href="#"
                    data-bs-toggle="modal"
                    data-bs-target="#termsModal"
                    >terms & conditions</a
                  >
                </label>
              </div>
              <button
                type="submit"
                class="btn btn-primary btn-lg w-100 py-3 mb-3"
              >
                <i class="fas fa-calendar-check me-2"></i> Book Now
              </button>
              <a
                [href]="getWhatsAppUrl()"
                class="btn btn-success btn-lg w-100 py-3"
                target="_blank"
              >
                <i class="fab fa-whatsapp me-2"></i> WhatsApp Inquiry
              </a>
            </form>
            <hr class="my-4" />
            <div class="text-center">
              <div class="d-flex justify-content-center mb-3">
                <i class="fas fa-headset fa-2x text-primary me-3"></i>
                <div>
                  <h5 class="mb-0">Need Help?</h5>
                  <a href="tel:+918188007557" class="text-secondary"
                    >+91 81880-07557</a
                  >
                </div>
              </div>
              <p class="small text-muted">
                We're available 24/7 to assist with your booking
              </p>
            </div>
          </div>
        </div>

        <!-- Terms Modal -->
        <div
          class="modal fade"
          id="termsModal"
          tabindex="-1"
          aria-labelledby="termsModalLabel"
          aria-hidden="true"
        >
          <div class="modal-dialog modal-dialog-scrollable">
            <div class="modal-content">
              <div class="modal-header bg-primary text-white">
                <h5 class="modal-title" id="termsModalLabel">Pricing Terms</h5>
                <button
                  type="button"
                  class="btn-close btn-close-white"
                  data-bs-dismiss="modal"
                  aria-label="Close"
                ></button>
              </div>
              <div class="modal-body">
                <h6 class="text-primary">Package Pricing Structure</h6>
                <table class="table table-sm table-bordered">
                  <thead class="table-light">
                    <tr>
                      <th>Group Size</th>
                      <th class="text-end">Total Cost</th>
                      <th class="text-end">Per Person</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr
                      *ngFor="let pricing of tourDetails.pricingDetails"
                      [class.table-primary]="pricing.groupSize === 5"
                    >
                      <td>{{ pricing.groupSize }} People</td>
                      <td class="text-end">
                        ₹{{ pricing.basePackageTotal | number : "1.0-0" }}
                      </td>
                      <td
                        class="text-end"
                        [class.fw-bold]="pricing.groupSize === 5"
                      >
                        ₹{{ pricing.pricePerPerson | number : "1.0-0" }}
                      </td>
                    </tr>
                  </tbody>
                </table>
                <div class="alert alert-info small">
                  <i class="fas fa-info-circle me-2"></i>
                  <strong>Note:</strong> For groups larger than 5, an additional
                  ₹3,500 per person will be charged for each extra member beyond
                  5.
                </div>
              </div>
              <div class="modal-footer">
                <button
                  type="button"
                  class="btn btn-primary"
                  data-bs-dismiss="modal"
                >
                  I Understand
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Why Choose Us -->
        <div class="card shadow-sm border-0 mt-4">
          <div class="card-header bg-warning text-dark">
            <h4 class="mb-0">Why Choose Us</h4>
          </div>
          <div class="card-body">
            <div class="d-flex mb-3">
              <div class="me-3">
                <i class="fas fa-check-circle text-success fa-lg"></i>
              </div>
              <div>
                <h6 class="mb-1">Local Experts</h6>
                <p class="small mb-0">
                  Our guides are Varanasi natives with deep knowledge of the
                  city's spiritual and cultural heritage.
                </p>
              </div>
            </div>
            <div class="d-flex mb-3">
              <div class="me-3">
                <i class="fas fa-check-circle text-success fa-lg"></i>
              </div>
              <div>
                <h6 class="mb-1">Skip-the-Line Access</h6>
                <p class="small mb-0">
                  Priority access to major attractions to maximize your time.
                </p>
              </div>
            </div>
            <div class="d-flex mb-3">
              <div class="me-3">
                <i class="fas fa-check-circle text-success fa-lg"></i>
              </div>
              <div>
                <h6 class="mb-1">Flexible Cancellation</h6>
                <p class="small mb-0">
                  Free cancellation up to 24 hours before your tour.
                </p>
              </div>
            </div>
            <div class="d-flex">
              <div class="me-3">
                <i class="fas fa-check-circle text-success fa-lg"></i>
              </div>
              <div>
                <h6 class="mb-1">Women-Friendly</h6>
                <p class="small mb-0">
                  Female guides available on request for solo women travelers.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
